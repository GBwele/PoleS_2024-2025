{% extends 'base.html.twig' %}

{% block title %}Hello ProductsController!{% endblock %}

{% block body %}
    <div class="{{ classe_banniere }} banner_size">

    <h1 id="products_titles">Tous nos {{categorie}}</h1>


      
    </div>
<div id="produits_page">




{% for produit in produits %}

<div class="produits_blocks">
  <div class="produit">
    <a href="{{path('app_details', {id: produit.id})}}"><img  src="{{asset('assets/img/' ~ categorie ~ '/' ~ produit.images)}}" alt="{{produit.nom}}" class="produit-image"></a>
  
    <h4 class="produit-nom">{{produit.nom}}</h4>
    <h6 class="produit-prix">{{produit.prix}} €</h6>
    <a href="{{path('app_details', {id: produit.id})}}"><button class="details" >details</button></a>
    <button class="add_panier" data-id="{{ produit.id }}">ajouter au panier</button>
  </div> 
</div>

{% endfor %}
</div>

<h2>Panier</h2>
<div class="cart">
<!-- Le contenu du panier sera chargé ici via AJAX -->
</div>

{% endblock %}

{# {% block javascripts %}
  <script>
  
  $(document).ready(function(){

 // Fonction pour ajouter un produit au panier
            $('.add-to-cart').click(function() {
                var productId = $(this).data('id');
                $.ajax({
                    url: '{{ path('cart_add') }}',
                    type: 'POST',
                    data: { id: productId },
                    success: function(response) {
                        alert(response.success);
                        loadCart();
                    },
                    error: function(xhr) {
                        alert(xhr.responseJSON.error);
                    }
                });

  });

   // Fonction pour charger le panier
            function loadCart() {
                $.ajax({
                    url: '{{ path('cart_view') }}',
                    type: 'GET',
                    success: function(cart) {
                        var cartHtml = '';
                        var total = 0;
                        for (var id in cart) {
                            if (cart.hasOwnProperty(id)) {
                                var item = cart[id];
                                var itemTotal = item.price * item.quantity;
                                total += itemTotal;
                                cartHtml += '<p>' + item.name + ' - ' + item.quantity + ' x ' + item.price + ' € = ' + itemTotal + ' €</p>';
                            }
                        }
                        cartHtml += '<strong>Total : ' + total + ' €</strong>';
                        $('#cart').html(cartHtml);
                    }
                });
            }

            // Charger le panier au chargement de la page
            loadCart();
        });
    </script>
{% endblock %} #}

  
